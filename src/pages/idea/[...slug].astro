---
import { getCollection, render } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Drawer from "@layouts/Drawer.astro";
import Article from "@layouts/Article.astro";

import Tags from "@components/idea/Tags.astro";
import Title from "@components/idea/Title.astro";
import Author from "@components/idea/Author.astro";

export async function getStaticPaths() {
  const ideas = await getCollection("ideas");
  return ideas.map(idea => {
    let slug = idea.filePath
    slug = slug?.replace(/^idea\//, "");
    slug = slug?.replace(/\.mdx?$/, "");
    return {
      params: { slug },
      props : { idea },
    }
  });
}

const { idea    } = Astro.props;
const { Content } = await render(idea);
---

<Layout>
  <Drawer>
    <Article>
      <Author author={idea.data.author}/>
      <Title title={idea.data.title}/>      
      <Tags tags={idea.data.tags}/>
      <Content/>
    </Article>
  </Drawer>
</Layout>